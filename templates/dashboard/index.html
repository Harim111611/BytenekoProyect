{% extends "base_dashboard.html" %}
{% block title %}Dashboard | Byteneko{% endblock %}

{% block content %}
<div class="container-fluid pb-4">

  <!-- Encabezado + filtros -->
  <div class="d-flex align-items-center justify-content-between mb-3">
    <div>
      <h1 class="dash-title">Dashboard</h1>
      <div class="dash-subtitle">Resumen general de tu actividad</div>
    </div>

    <div class="d-flex gap-2">
      <div class="dropdown">
        <button class="btn btn-filter dropdown-toggle" data-bs-toggle="dropdown">
          Últimos 30 d
        </button>
        <ul class="dropdown-menu dropdown-menu-end">
          <li><a class="dropdown-item" href="#">Últimos 7 d</a></li>
          <li><a class="dropdown-item" href="#">Últimos 30 d</a></li>
          <li><a class="dropdown-item" href="#">Este mes</a></li>
          <li><a class="dropdown-item" href="#">Mes anterior</a></li>
        </ul>
      </div>
      <div class="dropdown">
        <button class="btn btn-filter dropdown-toggle" data-bs-toggle="dropdown">
          General
        </button>
        <ul class="dropdown-menu dropdown-menu-end">
          <li><a class="dropdown-item" href="#">General</a></li>
          <li><a class="dropdown-item" href="#">Segmento A</a></li>
          <li><a class="dropdown-item" href="#">Segmento B</a></li>
        </ul>
      </div>
    </div>
  </div>

  <!-- KPIs -->
  <div class="row g-3 mb-3">
    <div class="col-12 col-xl-3 col-md-6">
      <div class="kpi-card">
        <div class="kpi-label">Encuestas activas</div>
        <div class="kpi-value">12</div>
        <div class="kpi-delta text-success">+3 vs mes anterior</div>
      </div>
    </div>
    <div class="col-12 col-xl-3 col-md-6">
      <div class="kpi-card">
        <div class="kpi-label">Respuestas hoy</div>
        <div class="kpi-value">147</div>
        <div class="kpi-delta text-success">+12%</div>
      </div>
    </div>
    <div class="col-12 col-xl-3 col-md-6">
      <div class="kpi-card">
        <div class="kpi-label">Total respuestas</div>
        <div class="kpi-value">3,200</div>
        <div class="kpi-delta">&nbsp;</div>
      </div>
    </div>
    <div class="col-12 col-xl-3 col-md-6">
      <div class="kpi-card">
        <div class="kpi-label">Tasa de finalización</div>
        <div class="kpi-value">83%</div>
        <div class="kpi-delta text-success">+5%</div>
      </div>
    </div>
  </div>

  <!-- Gráfica -->
  <div class="panel mb-3">
    <div class="panel-body">
      <div class="panel-title">Respuestas por día</div>
      <canvas id="respPorDia" height="100"></canvas>
    </div>
  </div>

  <!-- Actividad reciente -->
  <div class="panel">
    <div class="panel-body">
      <div class="d-flex align-items-center justify-content-between">
        <div>
          <div class="section-title">Actividad reciente</div>
          <div class="section-sub">Seguimiento de tus encuestas activas</div>
        </div>
        <div class="d-flex gap-2">
          <button class="btn btn-light btn-sm">
            <i class="bi bi-clipboard-data me-1"></i> Generar reporte PDF
          </button>
          <button class="btn btn-primary btn-sm">
            <i class="bi bi-plus-lg me-1"></i> Nueva encuesta
          </button>
        </div>
      </div>

      <div class="table-responsive mt-3">
        <table class="table align-middle mb-0">
          <thead class="table-head-light">
            <tr>
              <th>Encuesta</th>
              <th class="w-15">Estado</th>
              <th class="w-15">Muestra</th>
              <th class="w-25">Avance</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Satisfacción Q3</td>
              <td><span class="badge badge-soft-success">Activa</span></td>
              <td>500</td>
              <td>
                <div class="progress progress-thin">
                  <div class="progress-bar" style="width:83%"></div>
                </div>
                <span class="cell-note">83%</span>
              </td>
            </tr>
            <tr>
              <td>Concepto Bebidas</td>
              <td><span class="badge badge-soft-success">Activa</span></td>
              <td>300</td>
              <td>
                <div class="progress progress-thin">
                  <div class="progress-bar" style="width:62%"></div>
                </div>
                <span class="cell-note">62%</span>
              </td>
            </tr>
            <tr>
              <td>Awareness Marca X</td>
              <td><span class="badge badge-soft-muted">Finalizada</span></td>
              <td>1,000</td>
              <td>
                <div class="progress progress-thin">
                  <div class="progress-bar" style="width:100%"></div>
                </div>
                <span class="cell-note">100%</span>
              </td>
            </tr>
            <tr>
              <td>Test Producto A</td>
              <td><span class="badge badge-soft-success">Activa</span></td>
              <td>200</td>
              <td>
                <div class="progress progress-thin">
                  <div class="progress-bar" style="width:45%"></div>
                </div>
                <span class="cell-note">45%</span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

    </div>
  </div>

</div>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1"></script>
<script>
(() => {
  const ctx = document.getElementById('respPorDia');
  if (!ctx) return;
  new Chart(ctx, {
    type: 'line',
    data: {
      labels: ['Lun','Mar','Mié','Jue','Vie','Sáb','Dom'],
      datasets: [{
        data: [150, 220, 170, 300, 260, 120, 90],
        borderColor: '#3b82f6',
        backgroundColor: 'rgba(59,130,246,.15)',
        pointBackgroundColor: '#3b82f6',
        pointBorderColor: '#3b82f6',
        pointRadius: 4,
        tension: .35
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: { legend: { display: false }, tooltip: { mode: 'index', intersect: false } },
      scales: {
        x: {
          grid: { color: '#eee', drawBorder: false },
          ticks: { color: '#6b7280' }
        },
        y: {
          min: 0, max: 320, ticks: { stepSize: 75, color: '#6b7280' },
          grid: { color: '#eee', drawBorder: false }
        }
      }
    }
  });
})();
</script>
{% endblock %}
